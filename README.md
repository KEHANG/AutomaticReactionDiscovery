# AutomaticReactionDiscovery
Using quantum chemical computation to find important reactions without
requiring human intuition.

## Description
This repository contains Python code for automatically discovering chemical
reactions using a freezing string method with a subsequent exact transition
state search and reaction path verification by intrinsic reaction coordinate
calculation.

There are two parts required in order to run the whole program. First, initial
geometries and transition state jobs have to be generated by executing
`python ard.py input.txt` from the command line. This will generate a `reactions`
folder containing submission scripts and input files for each job. It will also
create a script in the starting directory. This script can then be run to
submit all transition state searches.

Initially, an input file with all required arguments and an example submission
script called `submit.*` have to be available. An example script is provided.
Every instance of "NAME" in the example script will be replaced by the name of
the job that it corresponds to.

It is also possible to only run a freezing string method (without exact TS
search and IRC calculation) by executing
`python sm.py input.txt`
A full transition state search (for only one reaction) can be run by executing
`python tssearch.py input.txt`

Several arguments can be specified in the input file in the format _arg value_.
The possible arguments are:

* `job_cmd`        - Command to submit batch jobs (typically `qsub` or `sbatch`)
* `reac_smi`       - Valid SMILES string describing the reactant structure
* `nbreak`         - Maximum number of bonds that may be broken
* `nform`          - Maximum number of bonds that may be formed
* `dH_cutoff`      - Heat of reaction cutoff (kcal/mol)
* `forcefield`     - Force field for 3D geometry generation (`mmff94` or `uff`)
* `distance`       - Initial distance between molecules
* `method`         - FSM or GSM (currently only FSM is supported)
* `geometry`       - Reactant and product geometry (see `main.py` for details)
* `nsteps`         - Number or gradient calculations per optimization step
* `nnode`          - Number of nodes for calculation of interpolation distance
* `lsf`            - Line search factor for Newton-Raphson optimization
* `tol`            - Perpendicular gradient tolerance
* `nLSTnodes`      - Number of high density LST nodes
* `qprog`          - Program for quantum calculations (`gau`, `qchem`, `nwchem`)
* `theory`         - Level of theory (e.g., m062x/cc-pvtz)
* `theory_preopt`  - Level of theory for pre-optimization of product
* `nproc`          - Number of processors per job
* `mem`            - Memory requirements for quantum software

Only `reac_smi` has to be specified for a full automatic discovery, all other
arguments have default values or are set by running `ard.py`.
Default values are:
* `job_cmd` = `qsub`
* `nbreak` = 3
* `nform` = 3
* `dH_cutoff` = 20
* `forcefield` = mmff94
* `distance` = 3.5
* `method` = fsm
* `nsteps` = 4
* `nnode` = 15
* `lsf` = 0.7
* `tol` = 0.1
* `nLSTnodes` = 100
* `qprog` = gau
* `theory` = m062x/cc-pvtz
* `nproc` = 1
* `mem` = 2000mb

The input file arguments can be specified in any order and comments can be
added. An example is given in _input.txt_. If a freezing string method or
single transition state search is run, `geometry` has to be specified.

An electronic structure program has to be available at the command line and the
appropriate environment variables have to be set.
